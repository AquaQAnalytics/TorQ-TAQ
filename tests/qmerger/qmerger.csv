action,ms,bytes,lang,code,repeat,minver,comment,
before,0,,q,"hdbdir:hsym`$getenv[`KDBHDB],"/" ",1,0,set hdb env ,
before,0,,q,tempdbdir:hsym `$getenv[`TORQTAQTEMPDB],1,0,set tempdb env ,
before,0,,q,mergedir:hsym `$getenv[`TORQTAQMERGED],1,0,set merge env,
before,0,,q,testdir:hsym`$getenv[`KDBTESTS],1,0,set test env,
before,0,,q,input1:`tablepath`tabletype`loadid`tabledate!(`$"/" sv (string testdir;"quoteB";"2020.01.03";"quote");`quote;1;2018.01.03),1,0,set correct input,
before,0,,q,input2:`tablepath`tabletype`loadid`tabledate!(`$"/" sv (string testdir;"quoteA";"2020.01.03";"quote");1;2018.01.03),1,0,set 'splitnonexistant' input,
before,0,,q,input3:`tablepath`tabletype`loadid`tabledate!("/" sv (string testdir;"quoteB";"2020.01.03";"quote");`quote;1;2018.01.03),1,0,set 'type' error input,
run,0,,q,result1:mergesplit input1,0,0,run merge function,
run,0,,q,result2:mergesplit input2,0,0,run merge function,
run,0,,q,result3:mergesplit input3,0,0,run merge function,
true,0,,q,(raze value type each result)~(-1 10 -12 -7 -11 -1h),0,0,compare result types,
true,0,,q,result1[`mergestatus]=1b,0,0,check merge was successful,
true,0,,q,result2[`mergemessage]="Unsuccessful: splitnonexistant",0,0,check error mergemessage,
true,0,,q,result3[`mergemessage]="Unsuccessful: type",0,0,check error mergemessage,
run,0,,q,result4:movetohdb 2018.01.03,0,0,run move to hdb function,
true,0,,q,result4~1b,0,0,check movetohdb result,